<!-- Chosen Palette: Logistic Serenity (Navy Blue, Safety Orange accents, Warm Neutral Background) -->
<!-- Application Structure Plan: The application is designed as a digital interactive learning module for TSMEL learners.
    1. 'Accueil': Context setting.
    2. 'Logistique S√©dentaire': Focus on the 6h rule and definitions.
    3. 'Transport Routier': Dashboard-style presentation of RSE limits.
    4. 'M√©thodes & Calculs': Detailed course content on ETP calculations.
    5. 'Simulateurs & Cas Pratiques': UPDATED SECTION. 
        - Tab 1: Tropik Drive (Classic ETP calc).
        - Tab 2: LogistiTech (New Crisis Management Case). Interactive step-by-step resolution with financial comparison chart.
    6. 'Synth√®se': Comparison table.
    This structure ensures the support acts as a complete training platform. -->
<!-- Visualization & Content Choices:
    1. 'LogistiTech Visuals': Use of timeline styling for the scenario context.
    2. 'Cost Comparison Chart': Vertical Bar Chart to compare Option A, B, and C costs dynamically.
    3. 'Step-by-Step UI': Accordion or progressive disclosure layout for the case study to guide the learner.
    CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->

<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestion des Temps & Dimensionnement - TSMEL</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f5f5f0; /* Warm Neutral */
            color: #1f2937;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        ::-webkit-scrollbar-thumb {
            background: #cbd5e1; 
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8; 
        }

        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }

        .tab-active {
            border-bottom: 3px solid #ea580c; /* Orange-600 */
            color: #1e3a8a; /* Blue-900 */
            font-weight: 700;
        }
        
        .tab-inactive {
            border-bottom: 3px solid transparent;
            color: #6b7280;
            font-weight: 400;
        }
        
        .tab-inactive:hover {
            color: #1e3a8a;
            border-bottom: 3px solid #bfdbfe;
        }

        .card-shadow {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            transition: transform 0.2s ease-in-out;
        }
        
        .card-shadow:hover {
            transform: translateY(-2px);
        }

        /* Step styling for Case Study */
        .step-circle {
            width: 2rem;
            height: 2rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        .step-active {
            background-color: #ea580c;
            color: white;
        }
        .step-inactive {
            background-color: #e5e7eb;
            color: #9ca3af;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <!-- Header -->
    <header class="bg-blue-900 text-white shadow-lg">
        <div class="max-w-7xl mx-auto px-4 py-6 sm:px-6 lg:px-8 flex flex-col md:flex-row justify-between items-center">
            <div>
                <h1 class="text-3xl font-bold tracking-tight">Gestion des Temps & Ressources</h1>
                <p class="mt-1 text-blue-200 text-sm">Formation TSMEL - Module AT1 / CP1</p>
            </div>
            <div class="mt-4 md:mt-0 flex space-x-2 text-sm bg-blue-800 rounded-lg p-2">
                <span class="flex items-center px-2">‚è±Ô∏è Pilotage</span>
                <span class="flex items-center px-2">‚öñÔ∏è R√©glementation</span>
                <span class="flex items-center px-2">üìä Performance</span>
            </div>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="bg-white shadow sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-14 overflow-x-auto">
                <div class="flex space-x-4 md:space-x-8 w-full" id="nav-container">
                    <!-- Nav items injected via JS -->
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content Area -->
    <main class="flex-grow max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 w-full">
        
        <!-- View: Accueil -->
        <section id="view-home" class="hidden animate-fade-in">
            <div class="bg-white rounded-xl p-8 card-shadow mb-8">
                <h2 class="text-2xl font-bold text-blue-900 mb-4">Introduction : Le Paradoxe Logistique</h2>
                <div class="grid md:grid-cols-2 gap-8 items-center">
                    <div>
                        <p class="text-gray-700 leading-relaxed mb-4">
                            La logistique moderne op√®re sous une double contrainte : l'exigence de <strong>performance</strong> (fluidit√©, rapidit√© J+1) et la n√©cessit√© de <strong>l√©galit√©</strong> (respect strict du cadre social).
                        </p>
                        <div class="bg-orange-50 border-l-4 border-orange-500 p-4 mb-4">
                            <p class="font-bold text-orange-800">Le r√¥le du TSMEL</p>
                            <p class="text-sm text-orange-700">Ma√Ætriser la r√©glementation n'est pas seulement une obligation juridique, c'est un levier de rentabilit√©. Un mauvais dimensionnement entra√Æne co√ªts inutiles ou risques sociaux.</p>
                        </div>
                        <h3 class="font-bold text-gray-800 mt-6 mb-2">Objectifs du module :</h3>
                        <ul class="list-disc list-inside text-gray-600 space-y-1">
                            <li>Distinguer les cadres r√©glementaires (S√©dentaire vs Roulant).</li>
                            <li>Comprendre le calcul des ETP et du Coefficient d'Engagement.</li>
                            <li>Analyser l'ad√©quation charge/capacit√© (Cas Tropik Drive).</li>
                            <li>Planifier les ressources sous contrainte (Cas LogistiTech).</li>
                        </ul>
                    </div>
                    <div class="bg-blue-50 rounded-lg p-6 flex flex-col justify-center items-center text-center">
                        <div class="text-6xl mb-4">‚öñÔ∏è</div>
                        <h3 class="text-xl font-bold text-blue-900">Performance vs Conformit√©</h3>
                        <p class="text-sm text-blue-700 mt-2">Le d√©fi quotidien du gestionnaire logistique.</p>
                        <button onclick="app.navigate('warehouse')" class="mt-6 px-6 py-2 bg-blue-600 text-white rounded-full hover:bg-blue-700 transition">Commencer le Module</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- View: Warehouse (S√©dentaire) -->
        <section id="view-warehouse" class="hidden animate-fade-in">
            <div class="mb-6">
                <h2 class="text-2xl font-bold text-blue-900">La Logistique S√©dentaire (Entrep√¥t)</h2>
                <p class="text-gray-600 mt-2">Ce module d√©taille les r√®gles du Code du Travail appliqu√©es aux pr√©parateurs de commandes et caristes. La ma√Ætrise de ces r√®gles est indispensable pour construire des plannings l√©gaux et efficaces.</p>
            </div>

            <div class="grid md:grid-cols-3 gap-6 mb-8">
                <!-- Card 1 -->
                <div class="bg-white p-6 rounded-xl card-shadow border-t-4 border-blue-500">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="font-bold text-lg">Dur√©e du Travail</h3>
                        <span class="text-2xl">‚è±Ô∏è</span>
                    </div>
                    <div class="text-3xl font-bold text-gray-800 mb-2">35h</div>
                    <p class="text-sm text-gray-500 mb-4">R√©f√©rence l√©gale hebdomadaire.</p>
                    <ul class="text-sm text-gray-700 space-y-2 bg-gray-50 p-3 rounded">
                        <li class="flex justify-between"><span>Seuil Heures Supp:</span> <strong>Au-del√† de 35h</strong></li>
                        <li class="flex justify-between"><span>Max Hebdo Absolu:</span> <strong>48 h</strong></li>
                        <li class="flex justify-between"><span>Max Hebdo Moy.:</span> <strong>44 h</strong></li>
                    </ul>
                </div>
                <!-- Card 2 -->
                <div class="bg-white p-6 rounded-xl card-shadow border-t-4 border-red-500">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="font-bold text-lg">La R√®gle des 6 Heures</h3>
                        <span class="text-2xl">‚òï</span>
                    </div>
                    <p class="text-gray-700 text-sm mb-4">Imp√©ratif de sant√© et s√©curit√© (Code du Travail).</p>
                    <div class="bg-red-50 p-3 rounded border border-red-100 mb-2">
                        <p class="text-red-800 font-semibold text-sm">D√®s 6h de travail cons√©cutif ‚Üí 20 min de pause OBLIGATOIRE.</p>
                    </div>
                    <p class="text-xs text-gray-500">Exemple: Poste 5h00-12h00 (7h) = Pause obligatoire (ex: √† 9h00).</p>
                </div>
                <!-- Card 3 -->
                <div class="bg-white p-6 rounded-xl card-shadow border-t-4 border-indigo-500">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="font-bold text-lg">Travail de Nuit</h3>
                        <span class="text-2xl">üåô</span>
                    </div>
                    <div class="text-xl font-bold text-indigo-900 mb-2">21h00 - 06h00</div>
                    <p class="text-sm text-gray-600 mb-4">D√©finition l√©gale pour les s√©dentaires (sauf accord sp√©cifique).</p>
                    <div class="space-y-2 text-sm">
                        <p><strong>Statut "Travailleur de Nuit":</strong></p>
                        <ul class="list-disc list-inside text-gray-600 pl-2">
                            <li>2x/semaine (min 3h)</li>
                            <li>Ou 270h / an</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Interactive Concept: TTE -->
            <div class="bg-white rounded-xl p-8 card-shadow">
                <h3 class="font-bold text-xl mb-4">Temps de Travail Effectif (TTE)</h3>
                <p class="mb-4 text-gray-600">Le salari√© est √† disposition de l'employeur. Testez vos connaissances :</p>
                <div class="grid md:grid-cols-2 gap-4">
                    <div class="p-4 bg-green-50 rounded border border-green-200">
                        <h4 class="font-bold text-green-800 mb-2">‚úÖ Inclus (TTE)</h4>
                        <ul class="space-y-1 text-sm text-green-900">
                            <li>‚Ä¢ Pr√©paration de commande</li>
                            <li>‚Ä¢ Conduite de chariot</li>
                            <li>‚Ä¢ Nettoyage de zone</li>
                            <li>‚Ä¢ Attente de directives</li>
                        </ul>
                    </div>
                    <div class="p-4 bg-gray-50 rounded border border-gray-200">
                        <h4 class="font-bold text-gray-800 mb-2">‚ùå Exclus (Non TTE)</h4>
                        <ul class="space-y-1 text-sm text-gray-700">
                            <li>‚Ä¢ Trajet domicile-travail</li>
                            <li>‚Ä¢ Pause (si libert√© totale)</li>
                            <li>‚Ä¢ Habillage (sauf convention)</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- View: Transport (Roulant) -->
        <section id="view-transport" class="hidden animate-fade-in">
            <div class="mb-6">
                <h2 class="text-2xl font-bold text-blue-900">Le Transport Routier (RSE)</h2>
                <div class="bg-blue-50 border-l-4 border-blue-600 p-4 mb-4">
                    <p class="text-blue-900 font-semibold">D√©finition : RSE</p>
                    <p class="text-sm text-blue-800">Dans ce contexte, RSE signifie <strong>R√©glementation Sociale Europ√©enne</strong> (R√®glement CE 561/2006) et non Responsabilit√© Soci√©tale des Entreprises.</p>
                </div>
                <p class="text-gray-600 mt-2">Le conducteur n'est pas un s√©dentaire. Ici, le chronotachygraphe fait la loi.</p>
            </div>

            <div class="grid lg:grid-cols-2 gap-8 mb-8">
                <!-- Interactive Dashboard Limits -->
                <div class="bg-white p-6 rounded-xl card-shadow">
                    <h3 class="font-bold text-lg mb-4 flex items-center gap-2">üöõ Limites de Conduite <span class="text-xs font-normal text-gray-500 bg-gray-100 px-2 py-1 rounded">RSE 561/2006</span></h3>
                    
                    <div class="space-y-6">
                        <!-- Conduite Continue -->
                        <div>
                            <div class="flex justify-between text-sm mb-1">
                                <span class="font-medium">Conduite Continue Max</span>
                                <span class="font-bold text-blue-600">4h30</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-4">
                                <div class="bg-blue-600 h-4 rounded-full" style="width: 100%"></div>
                            </div>
                            <p class="text-xs text-gray-500 mt-1">Apr√®s 4h30, pause obligatoire d'au moins 45 min (ou 15 + 30).</p>
                        </div>

                        <!-- Repos Journalier -->
                        <div>
                            <div class="flex justify-between text-sm mb-1">
                                <span class="font-medium">Repos Journalier Normal</span>
                                <span class="font-bold text-green-600">11h00</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-4 relative">
                                <div class="bg-green-500 h-4 rounded-full absolute top-0 left-0" style="width: 100%"></div>
                            </div>
                            <p class="text-xs text-gray-500 mt-1">Peut √™tre r√©duit √† 9h (3 fois par semaine max).</p>
                        </div>

                         <!-- Conduite Hebdo -->
                         <div>
                            <div class="flex justify-between text-sm mb-1">
                                <span class="font-medium">Max Hebdomadaire</span>
                                <span class="font-bold text-purple-600">56h00</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-4">
                                <div class="bg-purple-600 h-4 rounded-full" style="width: 62%"></div> <!-- 56/90 scale roughly -->
                            </div>
                            <p class="text-xs text-gray-500 mt-1">Max 90h sur 2 semaines cons√©cutives.</p>
                        </div>
                    </div>
                </div>

                <!-- Distinction Service vs Attente -->
                <div class="bg-white p-6 rounded-xl card-shadow">
                    <h3 class="font-bold text-lg mb-4 flex items-center gap-2">‚è±Ô∏è Symboles Tachygraphe & Temps</h3>
                    <div class="flex flex-col gap-4">
                        <div class="p-4 border rounded-lg bg-gray-50 hover:bg-white transition cursor-pointer">
                            <h4 class="font-bold text-gray-800">Temps de Service (Marteaux)</h4>
                            <p class="text-sm text-gray-600">Travaux divers (Chargement, B√¢chage, Papiers).</p>
                            <div class="mt-2 text-xs font-bold text-red-600">Max Jour : 12h</div>
                        </div>
                        
                        <div class="p-4 border rounded-lg bg-gray-50 hover:bg-white transition cursor-pointer">
                            <h4 class="font-bold text-gray-800">Temps d'Attente (Carr√© Barr√©)</h4>
                            <p class="text-sm text-gray-600">Attente au quai, vigilance sans t√¢che active. <strong>Ce n'est pas de la conduite.</strong></p>
                        </div>

                        <!-- Repos/Pause Block -->
                        <div class="p-4 border border-green-200 bg-green-50 rounded-lg">
                            <h4 class="font-bold text-green-900">Repos & Pauses (Lit)</h4>
                            <p class="text-sm text-green-800">Coupures et repos (libre de tout service).</p>
                            <div class="mt-2 text-xs font-bold text-green-700 flex items-center gap-2">
                                <span>Symbole Tachygraphe :</span>
                                <span class="text-lg">üõèÔ∏è (Lit)</span>
                            </div>
                        </div>

                        <div class="p-4 border border-indigo-200 bg-indigo-50 rounded-lg">
                            <h4 class="font-bold text-indigo-900">‚ö†Ô∏è La Guillotine de Nuit (Transport)</h4>
                            <p class="text-sm text-indigo-800">Si travail entre <strong class="underline">22h00 et 05h00</strong> :</p>
                            <p class="text-sm font-bold mt-1 text-red-600">‚Üí Service Journalier Max r√©duit √† 10h (au lieu de 12h).</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- View: Methods & Calculations (NEW) -->
        <section id="view-methods" class="hidden animate-fade-in">
            <div class="mb-6">
                <h2 class="text-2xl font-bold text-blue-900">M√©thodes de Calcul & Performance</h2>
                <p class="text-gray-600 mt-2">Le c≈ìur du m√©tier TSMEL : savoir transformer une charge de travail en besoin humain (ETP) et mesurer l'efficacit√© (Engagement).</p>
            </div>

            <div class="grid lg:grid-cols-2 gap-8 mb-8">
                <!-- ETP Course -->
                <div class="bg-white p-6 rounded-xl card-shadow border-t-4 border-orange-500">
                    <div class="flex items-center gap-3 mb-4">
                        <div class="p-2 bg-orange-100 rounded-lg text-orange-600 font-bold">1</div>
                        <h3 class="font-bold text-lg text-gray-800">Le Calcul des ETP</h3>
                    </div>
                    
                    <p class="text-sm text-gray-600 mb-4">L'√âquivalent Temps Plein (ETP) est l'unit√© de mesure de la capacit√© de travail. Il permet d'harmoniser les temps partiels et les contrats divers.</p>
                    
                    <div class="bg-gray-50 p-4 rounded-lg border border-gray-200 mb-4 font-mono text-sm">
                        <p class="font-bold text-gray-700 mb-2">// La Formule Fondamentale</p>
                        <p class="text-blue-600">ETP = Charge de travail (Heures) / Dur√©e L√©gale (Heures)</p>
                    </div>

                    <h4 class="font-bold text-gray-800 text-sm mb-2">Les Constantes Temporelles √† conna√Ætre :</h4>
                    <ul class="text-sm space-y-2 text-gray-600">
                        <li class="flex justify-between border-b pb-1">
                            <span>Hebdomadaire</span>
                            <span class="font-bold">35 Heures</span>
                        </li>
                        <li class="flex justify-between border-b pb-1">
                            <span>Mensuel (Base paie)</span>
                            <span class="font-bold">151,67 Heures</span>
                            <span class="text-xs text-gray-400 self-center">(35 √ó 52 / 12)</span>
                        </li>
                        <li class="flex justify-between border-b pb-1">
                            <span>Annuel (Plafond)</span>
                            <span class="font-bold">1 607 Heures</span>
                        </li>
                    </ul>
                </div>

                <!-- Coefficient Engagement Course -->
                <div class="bg-white p-6 rounded-xl card-shadow border-t-4 border-green-500">
                     <div class="flex items-center gap-3 mb-4">
                        <div class="p-2 bg-green-100 rounded-lg text-green-600 font-bold">2</div>
                        <h3 class="font-bold text-lg text-gray-800">Le Coefficient d'Engagement</h3>
                    </div>

                    <p class="text-sm text-gray-600 mb-4">Il mesure la densit√© du travail. C'est le rapport entre le temps "vendu" (ou allou√© par les standards) et le temps "pay√©" (pr√©sence).</p>

                    <div class="bg-gray-50 p-4 rounded-lg border border-gray-200 mb-4 font-mono text-sm">
                        <p class="font-bold text-gray-700 mb-2">// La Formule de Performance</p>
                        <p class="text-blue-600">Coeff = Heures Allou√©es (Gamme) / Heures Pay√©es</p>
                    </div>

                    <h4 class="font-bold text-gray-800 text-sm mb-2">Grille d'Analyse TSMEL :</h4>
                    <div class="space-y-3">
                        <div class="flex items-center gap-3">
                            <div class="w-3 h-3 rounded-full bg-red-500"></div>
                            <div class="text-sm">
                                <span class="font-bold text-red-700">&lt; 85% : Sous-activit√© (Surcapacit√©)</span>
                                <p class="text-xs text-gray-500">L'√©quipe attend le travail. Gaspillage financier.</p>
                            </div>
                        </div>
                        <div class="flex items-center gap-3">
                            <div class="w-3 h-3 rounded-full bg-green-500"></div>
                            <div class="text-sm">
                                <span class="font-bold text-green-700">85% - 95% : Zone Optimale</span>
                                <p class="text-xs text-gray-500">Bonne productivit√©, absorbe les micro-pauses.</p>
                            </div>
                        </div>
                        <div class="flex items-center gap-3">
                            <div class="w-3 h-3 rounded-full bg-orange-500"></div>
                            <div class="text-sm">
                                <span class="font-bold text-orange-700">&gt; 100% : Sur-activit√© (Sous-capacit√©)</span>
                                <p class="text-xs text-gray-500">Standards inatteignables ou heures supp non d√©clar√©es. Danger qualit√©/s√©curit√©.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- View: Simulator & Case Studies (UPDATED) -->
        <section id="view-simulator" class="hidden animate-fade-in">
            <div class="mb-6 flex flex-col md:flex-row md:justify-between md:items-center gap-4">
                <div>
                    <h2 class="text-2xl font-bold text-blue-900">Simulateurs & Cas Pratiques</h2>
                    <p class="text-gray-600 mt-2">Mise en application concr√®te.</p>
                </div>
                <!-- Sub-nav for Cases -->
                <div class="bg-white rounded-lg p-1 border inline-flex">
                    <button onclick="app.switchSim('tropik')" id="btn-tropik" class="px-4 py-2 rounded-md text-sm font-bold bg-blue-100 text-blue-900 shadow-sm transition-all">Tropik Drive (ETP)</button>
                    <button onclick="app.switchSim('logisti')" id="btn-logisti" class="px-4 py-2 rounded-md text-sm font-medium text-gray-500 hover:text-blue-900 transition-all flex items-center gap-2">
                        <span>üö® Le Crash LogistiTech</span>
                        <span class="bg-orange-500 text-white text-[10px] px-1 rounded">Nouveau</span>
                    </button>
                </div>
            </div>

            <!-- TAB 1: Tropik Drive (Existing) -->
            <div id="sim-tropik" class="grid lg:grid-cols-3 gap-8">
                <!-- Inputs Column -->
                <div class="bg-white p-6 rounded-xl card-shadow lg:col-span-1">
                    <h3 class="font-bold text-lg mb-4 text-gray-800 border-b pb-2">Donn√©es Op√©rationnelles</h3>
                    
                    <div class="space-y-4">
                        <div class="group">
                            <label class="block text-xs font-semibold text-gray-500 uppercase">Volume R√©ception (Palettes)</label>
                            <input type="number" id="input-vol-rec" value="180" class="w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 transition p-2 border">
                        </div>
                        <div class="group">
                            <label class="block text-xs font-semibold text-gray-500 uppercase">TU R√©ception (min/pal)</label>
                            <input type="number" id="input-tu-rec" value="8" class="w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 transition p-2 border">
                        </div>

                        <hr class="border-gray-100">

                        <div class="group">
                            <label class="block text-xs font-semibold text-gray-500 uppercase">Volume Pr√©paration (Colis)</label>
                            <input type="number" id="input-vol-prep" value="1200" class="w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 transition p-2 border">
                        </div>
                        <div class="group">
                            <label class="block text-xs font-semibold text-gray-500 uppercase">TU Pr√©paration (min/colis)</label>
                            <input type="number" id="input-tu-prep" value="5" class="w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 transition p-2 border">
                        </div>

                        <hr class="border-gray-100">

                        <div class="group">
                            <label class="block text-xs font-semibold text-gray-500 uppercase">Volume Exp√©dition (Palettes)</label>
                            <input type="number" id="input-vol-exp" value="200" class="w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 transition p-2 border">
                        </div>
                        <div class="group">
                            <label class="block text-xs font-semibold text-gray-500 uppercase">TU Exp√©dition (min/pal)</label>
                            <input type="number" id="input-tu-exp" value="6" class="w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 transition p-2 border">
                        </div>
                        
                        <div class="mt-4 p-3 bg-blue-50 rounded text-sm text-blue-800">
                            <strong>Note TSMEL :</strong> Modifier les TU (Temps Unitaires) impacte directement le coefficient d'engagement.
                        </div>
                    </div>
                </div>

                <!-- Visualization Column -->
                <div class="bg-white p-6 rounded-xl card-shadow lg:col-span-2 flex flex-col">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="font-bold text-lg text-gray-800">Analyse Charge vs Capacit√©</h3>
                        <div class="flex items-center space-x-2">
                            <span class="text-sm font-medium text-gray-600">Crash Test (Incident Mercredi)</span>
                            <button id="toggle-incident" class="bg-gray-200 relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2" role="switch" aria-checked="false">
                                <span aria-hidden="true" class="translate-x-0 pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out"></span>
                            </button>
                        </div>
                    </div>

                    <!-- Chart Container -->
                    <div class="chart-container w-full flex-grow">
                        <canvas id="etpChart"></canvas>
                    </div>

                    <!-- Results Summary -->
                    <div class="grid grid-cols-3 gap-4 mt-6 pt-4 border-t">
                        <div class="text-center">
                            <p class="text-xs text-gray-500 uppercase">Heures Requises</p>
                            <p id="res-hours" class="text-2xl font-bold text-blue-600">144.0 H</p>
                        </div>
                        <div class="text-center">
                            <p class="text-xs text-gray-500 uppercase">ETP Calcul√©s</p>
                            <p id="res-etp" class="text-2xl font-bold text-orange-600">4.11</p>
                        </div>
                        <div class="text-center">
                            <p class="text-xs text-gray-500 uppercase">Effectif Actuel</p>
                            <p class="text-2xl font-bold text-gray-400">12.00</p>
                        </div>
                    </div>

                    <div id="incident-alert" class="hidden mt-4 bg-red-50 border border-red-200 p-3 rounded-lg flex items-start space-x-3 animate-pulse">
                        <span class="text-2xl">üö®</span>
                        <div>
                            <p class="text-red-800 font-bold text-sm">Alerte Incident Mercredi !</p>
                            <p class="text-red-700 text-xs">+8h R√©ception (Camion impr√©vu) + 4h Cross-dock. Charge Totale passe √† 36h sur la journ√©e. Solution : Polyvalence (Mobilisation des polyvalents et caristes sur R√©ception puis Exp√©).</p>
                        </div>
                    </div>
                    <div id="analysis-text" class="mt-4 bg-yellow-50 border border-yellow-200 p-3 rounded-lg">
                        <p class="text-yellow-800 font-bold text-sm">Diagnostic : Surcapacit√© Structurelle</p>
                        <p class="text-yellow-700 text-xs">Avec 4.11 ETP requis pour 12 pr√©sents, le coefficient d'engagement est de 34%. Attention au co√ªt ! V√©rifiez vos standards (5 min/colis est lent).</p>
                    </div>
                </div>
            </div>

            <!-- TAB 2: LogistiTech (New Case Study) -->
            <div id="sim-logisti" class="hidden space-y-8">
                
                <!-- 1. Context Card -->
                <div class="bg-white rounded-xl card-shadow overflow-hidden">
                    <div class="bg-gray-800 text-white p-6 relative">
                        <div class="absolute top-0 right-0 p-4 opacity-20 text-6xl">üìâ</div>
                        <h3 class="text-2xl font-bold mb-2">√âtude de Cas : Le Crash de LogistiTech</h3>
                        <p class="text-gray-300 text-sm">Mardi 14 D√©cembre - 09h45. Panne R√©seau G√©n√©rale.</p>
                    </div>
                    <div class="p-6 grid md:grid-cols-2 gap-8">
                        <div>
                            <h4 class="font-bold text-gray-800 mb-2 border-b pb-1">Le Sc√©nario</h4>
                            <p class="text-gray-600 text-sm mb-4 leading-relaxed">
                                Le WMS est paralys√© pendant <strong>3 heures</strong> (09h45 - 12h45). 450 commandes "Premium" sont bloqu√©es.
                                Le Directeur, M. Morel, est obs√©d√© par le <strong>NPS (Satisfaction Client)</strong>. Il refuse tout retard mais surveille les co√ªts.
                            </p>
                            <div class="bg-orange-50 p-3 rounded border-l-4 border-orange-500">
                                <p class="text-orange-900 font-bold text-xs uppercase">Mission TSMEL</p>
                                <p class="text-orange-800 text-sm">Diagnostiquer l'impact et choisir la solution la moins co√ªteuse qui sauve la promesse client.</p>
                            </div>
                        </div>
                        <div class="bg-gray-50 p-4 rounded-lg text-sm space-y-2 border">
                            <h4 class="font-bold text-gray-800 mb-2">Donn√©es Cl√©s</h4>
                            <div class="grid grid-cols-2 gap-x-4 gap-y-2">
                                <div>üë• Effectif: <span class="font-bold">20</span></div>
                                <div>üì¶ Productivit√©: <span class="font-bold">15 lig/h</span></div>
                                <div>üí∂ Co√ªt Horaire: <span class="font-bold">19.50‚Ç¨</span></div>
                                <div>üìà Majoration HS: <span class="font-bold">25%</span></div>
                                <div>üöö Transport Std: <span class="font-bold">8‚Ç¨</span></div>
                                <div>üöÄ Transport Exp: <span class="font-bold">22‚Ç¨</span></div>
                                <div>‚ö†Ô∏è P√©nalit√© Retard: <span class="font-bold">15‚Ç¨</span></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 2. Interactive Resolution Steps -->
                <div class="grid lg:grid-cols-2 gap-8">
                    
                    <!-- Step-by-Step Inputs -->
                    <div class="bg-white p-6 rounded-xl card-shadow">
                        <h4 class="font-bold text-lg text-blue-900 mb-6">R√©solution Pas-√†-Pas</h4>
                        
                        <!-- Step 1 -->
                        <div class="mb-6 relative pl-8 border-l-2 border-gray-200">
                            <div class="absolute -left-[17px] top-0 step-circle step-active" id="step1-icon">1</div>
                            <h5 class="font-bold text-gray-800 mb-2">Diagnostic du Volume</h5>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="text-xs text-gray-500">Commandes Bloqu√©es</label>
                                    <input type="number" id="lt-cmd" value="450" class="w-full border rounded p-1 text-sm">
                                </div>
                                <div>
                                    <label class="text-xs text-gray-500">Lignes / Commande</label>
                                    <input type="number" id="lt-lignes" value="2" class="w-full border rounded p-1 text-sm">
                                </div>
                            </div>
                            <p class="text-right text-sm font-bold text-blue-600 mt-2">Total : <span id="lt-res-vol">900</span> lignes</p>
                        </div>

                        <!-- Step 2 -->
                        <div class="mb-6 relative pl-8 border-l-2 border-gray-200">
                            <div class="absolute -left-[17px] top-0 step-circle step-inactive" id="step2-icon">2</div>
                            <h5 class="font-bold text-gray-800 mb-2">Calcul du Temps de Rattrapage</h5>
                            <p class="text-xs text-gray-500 mb-2">Capacit√© de l'√©quipe (20 pers x 15 lig/h) = 300 lignes/h</p>
                            <div class="bg-blue-50 p-2 rounded flex justify-between items-center">
                                <span class="text-sm text-blue-800">Temps n√©cessaire :</span>
                                <span class="font-bold text-xl text-blue-900" id="lt-res-time">3.0 Heures</span>
                            </div>
                        </div>

                         <!-- Step 3 -->
                         <div class="relative pl-8 border-l-2 border-transparent">
                            <div class="absolute -left-[17px] top-0 step-circle step-inactive" id="step3-icon">3</div>
                            <h5 class="font-bold text-gray-800 mb-2">Arbitrage Financier</h5>
                            <p class="text-xs text-gray-600 mb-3">Analysez les 3 options dans le graphique ci-contre.</p>
                            
                            <div class="space-y-2">
                                <div class="flex items-center gap-2 p-2 border rounded hover:bg-gray-50 cursor-pointer" onclick="app.selectOption('A')">
                                    <input type="radio" name="decision" id="opt-A">
                                    <div class="text-sm">
                                        <span class="font-bold text-red-700">Option A : Laissez-faire</span>
                                        <span class="text-xs block text-gray-500">Exp√©dition J+1 (Std) + P√©nalit√©s Client</span>
                                    </div>
                                </div>
                                <div class="flex items-center gap-2 p-2 border rounded hover:bg-gray-50 cursor-pointer" onclick="app.selectOption('B')">
                                    <input type="radio" name="decision" id="opt-B">
                                    <div class="text-sm">
                                        <span class="font-bold text-orange-600">Option B : Transport Express</span>
                                        <span class="text-xs block text-gray-500">Exp√©dition J+1 (Express) pour rattraper le d√©lai</span>
                                    </div>
                                </div>
                                <div class="flex items-center gap-2 p-2 border rounded hover:bg-gray-50 cursor-pointer" onclick="app.selectOption('C')">
                                    <input type="radio" name="decision" id="opt-C">
                                    <div class="text-sm">
                                        <span class="font-bold text-green-700">Option C : Heures Suppl√©mentaires</span>
                                        <span class="text-xs block text-gray-500">Rattrapage le soir m√™me + Exp√©dition J+0 (Std)</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Visual Feedback -->
                    <div class="flex flex-col h-full">
                        <div class="bg-white p-6 rounded-xl card-shadow flex-grow flex flex-col">
                            <h4 class="font-bold text-lg text-gray-800 mb-4 text-center">Comparatif des Co√ªts Totaux (‚Ç¨)</h4>
                            <div class="chart-container flex-grow">
                                <canvas id="logistiChart"></canvas>
                            </div>
                            <div id="decision-feedback" class="mt-4 p-4 rounded-lg text-sm hidden">
                                <!-- Feedback injected here -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- View: Synthesis (Comparatif Only) -->
        <section id="view-synthesis" class="hidden animate-fade-in">
            <div class="mb-6">
                <h2 class="text-2xl font-bold text-blue-900">Synth√®se & Comparatif</h2>
                <p class="text-gray-600 mt-2">L'outil de r√©vision indispensable. Comparez les r√®gles s√©dentaires et roulantes en un coup d'≈ìil.</p>
            </div>

            <!-- Comparison Table -->
            <div class="bg-white rounded-xl shadow-lg overflow-hidden mb-8">
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-blue-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-blue-900 uppercase tracking-wider">Th√®me</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-blue-900 uppercase tracking-wider">S√©dentaire (Entrep√¥t)</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-blue-900 uppercase tracking-wider">Roulant (Transport > 3.5t)</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200 text-sm">
                            <tr class="hover:bg-gray-50 transition cursor-pointer group">
                                <td class="px-6 py-4 font-bold text-gray-900">Base Hebdo</td>
                                <td class="px-6 py-4 text-gray-600">35h (Moyenne)</td>
                                <td class="px-6 py-4 text-gray-600 group-hover:text-blue-600">35h / 39h / 43h (√âquivalences)</td>
                            </tr>
                            <tr class="hover:bg-gray-50 transition cursor-pointer group">
                                <td class="px-6 py-4 font-bold text-gray-900">Pause Obligatoire</td>
                                <td class="px-6 py-4 text-gray-600 bg-green-50">20 min apr√®s 6h travail</td>
                                <td class="px-6 py-4 text-gray-600 bg-orange-50 group-hover:font-bold">45 min apr√®s 4h30 conduite</td>
                            </tr>
                            <tr class="hover:bg-gray-50 transition cursor-pointer group">
                                <td class="px-6 py-4 font-bold text-gray-900">Travail de Nuit</td>
                                <td class="px-6 py-4 text-gray-600">21h00 - 06h00</td>
                                <td class="px-6 py-4 text-gray-600 group-hover:text-blue-600">22h00 - 05h00</td>
                            </tr>
                            <tr class="hover:bg-gray-50 transition cursor-pointer group">
                                <td class="px-6 py-4 font-bold text-gray-900">Sanction Nuit</td>
                                <td class="px-6 py-4 text-gray-600">Majoration salaire / Repos</td>
                                <td class="px-6 py-4 text-gray-600 text-red-600 font-semibold">Service Jour limit√© √† 10h MAX</td>
                            </tr>
                            <tr class="hover:bg-gray-50 transition cursor-pointer group">
                                <td class="px-6 py-4 font-bold text-gray-900">Contr√¥le</td>
                                <td class="px-6 py-4 text-gray-600">Badgeuse</td>
                                <td class="px-6 py-4 text-gray-600">Chronotachygraphe</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Conclusion Quote -->
            <div class="bg-blue-900 text-white p-8 rounded-xl text-center shadow-lg">
                <p class="text-xl italic font-serif mb-4">"L'agilit√© (modulation, polyvalence) est votre meilleure arme face √† la rigidit√© des lois."</p>
                <div class="h-1 w-20 bg-orange-500 mx-auto rounded"></div>
            </div>
        </section>

    </main>

    <!-- Footer -->
    <footer class="bg-gray-800 text-gray-300 py-6 mt-auto">
        <div class="max-w-7xl mx-auto px-4 text-center text-sm">
            <p>¬© 2025 Module TSMEL - Support de Cours Interactif.</p>
        </div>
    </footer>

    <!-- JavaScript Logic -->
    <script>
        // --- State Management ---
        const app = {
            currentView: 'home',
            data: {
                reception: { vol: 180, tu: 8 },
                prep: { vol: 1200, tu: 5 },
                expedition: { vol: 200, tu: 6 },
                incidentActive: false
            },
            logistiData: {
                cmd: 450,
                lignes: 2,
                coutH: 19.5,
                coutTrspStd: 8,
                coutTrspExp: 22,
                penalite: 15,
                majoration: 1.25,
                team: 20
            },
            navItems: [
                { id: 'home', label: 'üè† Accueil' },
                { id: 'warehouse', label: 'üè≠ Entrep√¥t (S√©dentaire)' },
                { id: 'transport', label: 'üöõ Transport (Roulant)' },
                { id: 'methods', label: 'üìê M√©thodes & Calculs' },
                { id: 'simulator', label: 'üßÆ Simulateurs & Cas' },
                { id: 'synthesis', label: 'üìã Synth√®se' }
            ],
            
            // --- Navigation Logic ---
            init: function() {
                this.renderNav();
                this.navigate('home');
                this.setupListeners();
                this.initChart();
                this.initLogistiChart();
                this.calculateETP(); // Initial calc for Tropik
                this.calcLogisti(); // Initial calc for Logisti
            },

            renderNav: function() {
                const navContainer = document.getElementById('nav-container');
                navContainer.innerHTML = this.navItems.map(item => `
                    <button 
                        onclick="app.navigate('${item.id}')" 
                        class="whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm transition-colors duration-200 tab-inactive"
                        id="nav-${item.id}"
                    >
                        ${item.label}
                    </button>
                `).join('');
            },

            navigate: function(viewId) {
                document.querySelectorAll('section[id^="view-"]').forEach(el => el.classList.add('hidden'));
                document.getElementById(`view-${viewId}`).classList.remove('hidden');
                
                this.navItems.forEach(item => {
                    const btn = document.getElementById(`nav-${item.id}`);
                    if(item.id === viewId) {
                        btn.classList.remove('tab-inactive');
                        btn.classList.add('tab-active');
                    } else {
                        btn.classList.add('tab-inactive');
                        btn.classList.remove('tab-active');
                    }
                });

                this.currentView = viewId;
                window.scrollTo(0,0);
            },

            // --- Simulator Switching Logic ---
            switchSim: function(simId) {
                if(simId === 'tropik') {
                    document.getElementById('sim-tropik').classList.remove('hidden');
                    document.getElementById('sim-logisti').classList.add('hidden');
                    document.getElementById('btn-tropik').className = "px-4 py-2 rounded-md text-sm font-bold bg-blue-100 text-blue-900 shadow-sm transition-all";
                    document.getElementById('btn-logisti').className = "px-4 py-2 rounded-md text-sm font-medium text-gray-500 hover:text-blue-900 transition-all flex items-center gap-2";
                } else {
                    document.getElementById('sim-tropik').classList.add('hidden');
                    document.getElementById('sim-logisti').classList.remove('hidden');
                    document.getElementById('btn-tropik').className = "px-4 py-2 rounded-md text-sm font-medium text-gray-500 hover:text-blue-900 transition-all";
                    document.getElementById('btn-logisti').className = "px-4 py-2 rounded-md text-sm font-bold bg-blue-100 text-blue-900 shadow-sm transition-all flex items-center gap-2";
                    this.logistiChartInstance.resize(); // Fix chart sizing on reveal
                }
            },

            // --- Tropik Drive Logic ---
            setupListeners: function() {
                // Tropik Inputs
                ['input-vol-rec', 'input-tu-rec', 'input-vol-prep', 'input-tu-prep', 'input-vol-exp', 'input-tu-exp'].forEach(id => {
                    const el = document.getElementById(id);
                    if(el) el.addEventListener('input', () => this.updateData());
                });

                // Incident Toggle
                const toggle = document.getElementById('toggle-incident');
                if(toggle) {
                    toggle.addEventListener('click', () => {
                        this.data.incidentActive = !this.data.incidentActive;
                        const knob = toggle.querySelector('span');
                        if(this.data.incidentActive) {
                            toggle.classList.remove('bg-gray-200');
                            toggle.classList.add('bg-orange-500');
                            knob.classList.add('translate-x-5');
                            document.getElementById('incident-alert').classList.remove('hidden');
                        } else {
                            toggle.classList.add('bg-gray-200');
                            toggle.classList.remove('bg-orange-500');
                            knob.classList.remove('translate-x-5');
                            document.getElementById('incident-alert').classList.add('hidden');
                        }
                        this.calculateETP();
                    });
                }

                // LogistiTech Inputs
                ['lt-cmd', 'lt-lignes'].forEach(id => {
                    const el = document.getElementById(id);
                    if(el) el.addEventListener('input', () => this.calcLogisti());
                });
            },

            updateData: function() {
                this.data.reception.vol = parseFloat(document.getElementById('input-vol-rec').value) || 0;
                this.data.reception.tu = parseFloat(document.getElementById('input-tu-rec').value) || 0;
                this.data.prep.vol = parseFloat(document.getElementById('input-vol-prep').value) || 0;
                this.data.prep.tu = parseFloat(document.getElementById('input-tu-prep').value) || 0;
                this.data.expedition.vol = parseFloat(document.getElementById('input-vol-exp').value) || 0;
                this.data.expedition.tu = parseFloat(document.getElementById('input-tu-exp').value) || 0;
                this.calculateETP();
            },

            calculateETP: function() {
                const recMins = this.data.reception.vol * this.data.reception.tu;
                const prepMins = this.data.prep.vol * this.data.prep.tu;
                const expMins = this.data.expedition.vol * this.data.expedition.tu;
                let totalHours = (recMins + prepMins + expMins) / 60;
                
                let incidentHours = 0;
                if(this.data.incidentActive) {
                    incidentHours = 12; 
                    totalHours += incidentHours;
                }

                const etpRequired = totalHours / 35;
                const existingETP = 12;

                const resHours = document.getElementById('res-hours');
                const resEtp = document.getElementById('res-etp');
                if(resHours) resHours.innerText = totalHours.toFixed(1) + " H";
                if(resEtp) resEtp.innerText = etpRequired.toFixed(2);
                
                const analysisEl = document.getElementById('analysis-text');
                if(analysisEl) {
                    const occupation = (etpRequired / existingETP) * 100;
                    if (occupation > 110) {
                        analysisEl.innerHTML = `<p class="text-red-800 font-bold text-sm">Diagnostic : Sous-capacit√© Critique (${occupation.toFixed(0)}%)</p><p class="text-red-700 text-xs">Risque de retard livraison.</p>`;
                        analysisEl.className = "mt-4 bg-red-50 border border-red-200 p-3 rounded-lg";
                    } else if (occupation < 50) {
                        analysisEl.innerHTML = `<p class="text-yellow-800 font-bold text-sm">Diagnostic : Surcapacit√© Structurelle (${occupation.toFixed(0)}%)</p><p class="text-yellow-700 text-xs">Gaspillage financier.</p>`;
                        analysisEl.className = "mt-4 bg-yellow-50 border border-yellow-200 p-3 rounded-lg";
                    } else {
                        analysisEl.innerHTML = `<p class="text-green-800 font-bold text-sm">Diagnostic : Zone Optimale (${occupation.toFixed(0)}%)</p><p class="text-green-700 text-xs">Bonne ad√©quation.</p>`;
                        analysisEl.className = "mt-4 bg-green-50 border border-green-200 p-3 rounded-lg";
                    }
                }

                this.updateChart(totalHours, existingETP * 35, incidentHours);
            },

            // --- LogistiTech Logic ---
            calcLogisti: function() {
                const cmd = parseFloat(document.getElementById('lt-cmd').value) || 0;
                const lignes = parseFloat(document.getElementById('lt-lignes').value) || 0;
                const totalLignes = cmd * lignes;
                
                // 20 pers * 15 lignes/h = 300 lignes/h capacity
                const capacityPerHour = 20 * 15;
                const timeNeeded = totalLignes / capacityPerHour;

                document.getElementById('lt-res-vol').innerText = totalLignes;
                document.getElementById('lt-res-time').innerText = timeNeeded.toFixed(1) + " Heures";

                // Step visual update
                if(totalLignes > 0) {
                    document.getElementById('step2-icon').classList.remove('step-inactive');
                    document.getElementById('step2-icon').classList.add('step-active');
                    document.getElementById('step3-icon').classList.remove('step-inactive');
                    document.getElementById('step3-icon').classList.add('step-active');
                }

                // Cost Calculations
                // Opt A: Standard Transp + Penalties
                const costA = (cmd * this.logistiData.coutTrspStd) + (cmd * this.logistiData.penalite);
                
                // Opt B: Express Transp
                const costB = (cmd * this.logistiData.coutTrspExp);

                // Opt C: Overtime + Standard Transp
                // HS Cost = Time * Team * CostH * Majoration
                const hsCost = timeNeeded * this.logistiData.team * this.logistiData.coutH * this.logistiData.majoration;
                const costC = hsCost + (cmd * this.logistiData.coutTrspStd);

                this.updateLogistiChart(costA, costB, costC);
            },

            selectOption: function(opt) {
                const feedbackEl = document.getElementById('decision-feedback');
                feedbackEl.classList.remove('hidden');
                
                if (opt === 'C') {
                    feedbackEl.className = "mt-4 p-4 rounded-lg text-sm bg-green-100 border border-green-300 text-green-900";
                    feedbackEl.innerHTML = "<strong>‚úÖ Excellente d√©cision !</strong><br>Les Heures Suppl√©mentaires (~5 000‚Ç¨) sont bien moins ch√®res que le Transport Express (~10 000‚Ç¨) ou les p√©nalit√©s (~10 300‚Ç¨).<br>De plus, vous sauvez le NPS en livrant J+1 (standard d√©part le soir m√™me). M. Morel validera.";
                } else if (opt === 'B') {
                    feedbackEl.className = "mt-4 p-4 rounded-lg text-sm bg-yellow-100 border border-yellow-300 text-yellow-900";
                    feedbackEl.innerHTML = "<strong>‚ö†Ô∏è Choix Acceptable mais Co√ªteux.</strong><br>Le Transport Express (~10 000‚Ç¨) sauve le client (NPS OK), mais co√ªte le double des Heures Suppl√©mentaires. M. Morel appr√©ciera la qualit√©, mais critiquera la gestion financi√®re.";
                } else {
                    feedbackEl.className = "mt-4 p-4 rounded-lg text-sm bg-red-100 border border-red-300 text-red-900";
                    feedbackEl.innerHTML = "<strong>‚ùå Mauvaise d√©cision.</strong><br>C'est l'option la plus ch√®re (~10 300‚Ç¨ avec p√©nalit√©s) et la pire pour le client (Livraison J+2). Le NPS va s'effondrer.";
                }
            },

            // --- Chart.js Instances ---
            chartInstance: null,
            logistiChartInstance: null,

            initChart: function() {
                const ctx = document.getElementById('etpChart');
                if(!ctx) return;
                this.chartInstance = new Chart(ctx.getContext('2d'), {
                    type: 'bar',
                    data: {
                        labels: ['Charge (H)', 'Capacit√© (H)'],
                        datasets: [
                            { label: 'Base', data: [0, 0], backgroundColor: ['#3b82f6', '#9ca3af'], borderRadius: 4, order: 2 },
                            { label: 'Incident', data: [0, 0], backgroundColor: '#f97316', borderRadius: 4, order: 1 }
                        ]
                    },
                    options: { responsive: true, maintainAspectRatio: false, scales: { x: { stacked: true }, y: { stacked: true } } }
                });
            },

            updateChart: function(totalNeeded, totalAvailable, incidentHours) {
                if(!this.chartInstance) return;
                const baseNeeded = totalNeeded - incidentHours;
                this.chartInstance.data.datasets[0].data = [baseNeeded, totalAvailable];
                this.chartInstance.data.datasets[1].data = [incidentHours, 0];
                this.chartInstance.update();
            },

            initLogistiChart: function() {
                const ctx = document.getElementById('logistiChart');
                if(!ctx) return;
                this.logistiChartInstance = new Chart(ctx.getContext('2d'), {
                    type: 'bar',
                    data: {
                        labels: ['Option A (Echec)', 'Option B (Express)', 'Option C (H. Sup)'],
                        datasets: [{
                            label: 'Co√ªt Total (‚Ç¨)',
                            data: [0, 0, 0],
                            backgroundColor: ['#ef4444', '#f97316', '#22c55e'],
                            borderRadius: 6
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false },
                            tooltip: { callbacks: { label: (c) => c.raw.toLocaleString('fr-FR', {style:'currency', currency:'EUR'}) } }
                        },
                        scales: { y: { beginAtZero: true } }
                    }
                });
            },

            updateLogistiChart: function(a, b, c) {
                if(!this.logistiChartInstance) return;
                this.logistiChartInstance.data.datasets[0].data = [a, b, c];
                this.logistiChartInstance.update();
            }
        };

        document.addEventListener('DOMContentLoaded', () => { app.init(); });
    </script>
</body>
</html>
